<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Variables especiales después de un emparejamiento</TITLE>
<META NAME="description" CONTENT="Variables especiales después de un emparejamiento">
<META NAME="keywords" CONTENT="perlexamples">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="mystyle.css">

<LINK REL="next" HREF="node54.html">
<LINK REL="previous" HREF="node52.html">
<LINK REL="up" HREF="node49.html">
<LINK REL="next" HREF="node54.html">
</HEAD>

<BODY >

<A NAME="tex2html1863"
  HREF="node54.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1857"
  HREF="node49.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1851"
  HREF="node52.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1859"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1861"
  HREF="node322.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html2"
  HREF="http://nereida.deioc.ull.es/~pl/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="PL.jpg"
 ALT="PL"></A><A NAME="tex2html3"
  HREF="http://campusvirtual.ull.es/0910/course/view.php?id=1148"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="hatpl.png"
 ALT="PL moodle"></A><A NAME="tex2html4"
  HREF="pl.ps"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="ps"></A><A NAME="tex2html5"
  HREF="perl_errata_form.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="icon_errata.jpg"
 ALT="errata"></A><A NAME="tex2html6"
  HREF="http://search.cpan.org/"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="modulos"></A><A NAME="tex2html7"
  HREF="http://www.perlmonks.org/?node=Seekers of Perl Wisdom"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="monk.gif"
 ALT="perlmonks"></A><A NAME="tex2html8"
  HREF="http://perldoc.perl.org/"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html9"
  HREF="http://nereida.deioc.ull.es/~lhp/perlexamples/"><IMG
  WIDTH="22" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLHP.jpg"
 ALT="apuntes LHP"></A><A NAME="tex2html10"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html11"
  HREF="http://www.etsii.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html12"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html13"
  HREF="http://nereida.deioc.ull.es/"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="pcgull"></A>
<BR>
<B> Sig:</B> <A NAME="tex2html1864"
  HREF="node54.html">Ambito Automático</A>
<B>Sup:</B> <A NAME="tex2html1858"
  HREF="node49.html">Introducción</A>
<B> Ant:</B> <A NAME="tex2html1852"
  HREF="node52.html">Tablas de Escapes, Metacarácteres,</A>
 <B>Err:</B> <a href="perl_errata_form.html" target="_blank">Si hallas una errata ...</a>
<BR> <P>

<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsecciones</STRONG></A>

<UL>
<LI><UL>
<LI><A NAME="tex2html1865"
  HREF="node53.html#SECTION00814010000000000000">Las Variables de match, pre-match y post-mach</A>
<LI><A NAME="tex2html1866"
  HREF="node53.html#SECTION00814020000000000000">Texto Asociado con el Último Paréntesis</A>
<LI><A NAME="tex2html1867"
  HREF="node53.html#SECTION00814030000000000000">Los Offsets de los Inicios de los Casamientos: <TT>@-</TT></A>
<LI><A NAME="tex2html1868"
  HREF="node53.html#SECTION00814040000000000000">Desplazamientos de los Finales de los Emparejamientos: <TT>@+</TT></A>
<LI><A NAME="tex2html1869"
  HREF="node53.html#SECTION00814050000000000000">Número de paréntesis en la última regexp con éxito</A>
<LI><A NAME="tex2html1870"
  HREF="node53.html#SECTION00814060000000000000">Indice del Ultimo Paréntesis</A>
<LI><A NAME="tex2html1871"
  HREF="node53.html#SECTION00814070000000000000"><TT>@-</TT> y <TT>@+</TT> no tienen que tener el mismo tamaño</A>
<LI><A NAME="tex2html1872"
  HREF="node53.html#SECTION00814080000000000000">Véase También</A>
</UL></UL>
<!--End of Table of Child-Links-->
<HR>

<H2><A NAME="SECTION00814000000000000000"></A>
<A NAME="section:variablesmagicasereg"></A>
<BR>
Variables especiales después de un emparejamiento
</H2>
Despues de un emparejamiento con éxito, las siguientes variables 
especiales quedan definidas:

<P>
<BR>
<BR>
<TABLE CELLPADDING=3 BORDER="1">
<TR><TD ALIGN="LEFT"><code>$&amp;</code></TD>
<TD ALIGN="LEFT">El texto que casó</TD>
</TR>
<TR><TD ALIGN="LEFT"><code>$`</code></TD>
<TD ALIGN="LEFT">El texto que está a la izquierda de lo que casó</TD>
</TR>
<TR><TD ALIGN="LEFT"><code>$'</code></TD>
<TD ALIGN="LEFT">El texto que está a la derecha de lo que casó</TD>
</TR>
<TR><TD ALIGN="LEFT"><code>$1, $2, $3</code>, etc.</TD>
<TD ALIGN="LEFT">Los textos capturados por los paréntesis</TD>
</TR>
<TR><TD ALIGN="LEFT"><code>$+</code></TD>
<TD ALIGN="LEFT">Una copia del <code>$1, $2,</code> ...con número mas alto</TD>
</TR>
<TR><TD ALIGN="LEFT"><code>@-</code></TD>
<TD ALIGN="LEFT">Desplazamientos de las subcadenas que casan en <code>$1</code> ...</TD>
</TR>
<TR><TD ALIGN="LEFT"><code>@+</code></TD>
<TD ALIGN="LEFT">Desplazamientos de los finales de las subcadenas  en <code>$1</code> ...</TD>
</TR>
<TR><TD ALIGN="LEFT"><code>$#-</code></TD>
<TD ALIGN="LEFT">El índice del último paréntesis que casó</TD>
</TR>
<TR><TD ALIGN="LEFT"><code>$#+</code></TD>
<TD ALIGN="LEFT">El índice del último paréntesis en la última expresión regular</TD>
</TR>
</TABLE>

<P>

<H4><A NAME="SECTION00814010000000000000">
Las Variables de match, pre-match y post-mach</A>
</H4>
  

<A NAME="parrafo:prematch"></A>
<P>
<BR>
<BR>
Ejemplo:
<PRE>
   1 #!/usr/bin/perl -w
   2 if ("Hello there, neighbor" =~ /\s(\w+),/) {
   3   print "That was: ($`)($&amp;)($').\n",
   4 }
</PRE>

<P>
<PRE>
&gt; matchvariables.pl
That was: (Hello)( there,)( neighbor).
</PRE>

<P>
El uso de estas variables tenía un efecto negativo en el rendimiento de la
regexp. Véase
<A NAME="tex2html63"
  HREF="http://search.cpan.org/perldoc/?perlfaq6"><TT>perlfaq6</TT></A>
la sección 
<code>Why does using $&amp;, $`, or $' slow my program down?</code>.

<P>
<BLOCKQUOTE><I>Once Perl sees that you need one of these variables anywhere in the
program, it provides them on each and every pattern match. That means
that on every pattern match the entire string will be copied, part of
it to <code>$`</code>, part to <code>$&amp;</code>, and part to <code>$'</code>. 
Thus the penalty is most severe
with long strings and patterns that match often. Avoid <code>$&amp;</code>, <code>$'</code>, and <code>$`</code>
if you can, but if you can't, once you've used them at all, use them at
will because you've already paid the price. Remember that some algorithms
really appreciate them. As of the 5.005 release, the <code>$&amp;</code> variable is no
longer "expensive" the way the other two are.
</I></BLOCKQUOTE>
<P>
<BLOCKQUOTE><I>Since Perl 5.6.1 the special variables <code>@-</code> and <code>@+</code> can functionally replace
<code>$`</code>, <code>$&amp;</code> and <code>$'</code>. These arrays contain pointers to the beginning and end of
each match (see <A NAME="tex2html62"
  HREF="http://search.cpan.org/perldoc/?perlvar"><TT>perlvar</TT></A>
for the full story), so they give you essentially
the same information, but without the risk of excessive string copying.
</I></BLOCKQUOTE>
<P>
<BLOCKQUOTE><I>Perl 5.10 added three specials, <code>${^MATCH}</code>, <code>${^PREMATCH}</code>, and <code>${^POSTMATCH}</code>
to do the same job but without the global performance penalty. Perl
5.10 only sets these variables if you compile or execute the regular
expression with the <code>/p</code> modifier.
</I></BLOCKQUOTE>

<P>
<PRE>
pl@nereida:~/Lperltesting$ cat ampersandoldway.pl
#!/usr/local/lib/perl/5.10.1/bin//perl5.10.1 -w
use strict;
use Benchmark qw(cmpthese timethese);

'hola juan' =~ /ju/;
my ($a, $b, $c) = ($`, $&amp;, $');


cmpthese( -1, {
    oldway =&gt; sub { 'hola juan' =~ /ju/  },
});
pl@nereida:~/Lperltesting$ cat ampersandnewway.pl
#!/usr/local/lib/perl/5.10.1/bin//perl5.10.1 -w
use strict;
use Benchmark qw(cmpthese timethese);

'hola juan' =~ /ju/p;
my ($a, $b, $c) = (${^PREMATCH}, ${^MATCH}, ${^POSTMATCH});


cmpthese( -1, {
    newway =&gt; sub { 'hola juan' =~ /ju/  },
});

pl@nereida:~/Lperltesting$ time ./ampersandoldway.pl
            Rate oldway
oldway 2991861/s     --

real    0m3.761s
user    0m3.740s
sys     0m0.020s
pl@nereida:~/Lperltesting$ time ./ampersandnewway.pl
            Rate newway
newway 8191999/s     --

real    0m6.721s
user    0m6.704s
sys     0m0.016s
</PRE>

<P>
Véase 

<UL>
<LI><A NAME="tex2html64"
  HREF="http://search.cpan.org/perldoc/?perlvar"><TT>perlvar</TT></A>
(busque por <code>$MATCH</code>)
</LI>
</UL>

<P>

<H4><A NAME="SECTION00814020000000000000">
Texto Asociado con el Último Paréntesis</A>
</H4>
  

<P>
La variable <code>$+</code> contiene el texto que casó
con el último paréntesis en el patrón. Esto es útil
en situaciones en las cuáles una de un conjunto de alternativas 
casa, pero no sabemos cuál:

<P>
<PRE>
  DB&lt;9&gt; "Revision: 4.5" =~ /Version: (.*)|Revision: (.*)/ &amp;&amp; ($rev = $+);
  DB&lt;10&gt; x $rev
0  4.5
  DB&lt;11&gt; "Version: 4.5" =~ /Version: (.*)|Revision: (.*)/ &amp;&amp; ($rev = $+);
  DB&lt;12&gt; x $rev
0  4.5
</PRE>

<P>

<H4><A NAME="SECTION00814030000000000000">
Los Offsets de los Inicios de los Casamientos: <TT>@-</TT></A>
</H4>
  

<A NAME="parrafo:iniciocas"></A>
<P>
El vector <code>@-</code> contiene los <I>offsets</I> o desplazamientos
de los casamientos en la última expresión regular.
La entrada <code>$-[0]</code> es el desplazamiento del último casamiento con éxito
y <code>$-[n]</code> es el desplazamiento de la subcadena que casa
con el <code>n</code>-ésimo paréntesis (o <code>undef</code> si el párentesis
no casó). Por ejemplo:

<P>
<PRE>
#           012345678
DB&lt;1&gt; $z = "hola13.47"
DB&lt;2&gt; if ($z =~ m{a(\d+)(\.(\d+))?}) { print "@-\n"; }
3 4 6 7
</PRE>
El resultado se interpreta como sigue:

<UL>
<LI>3 = desplazamiento de comienzo de <code>$&amp; = a13.47</code> 
</LI>
<LI>4 = desplazamiento de comienzo de <code>$1 = 13</code>
</LI>
<LI>6 = desplazamiento de comienzo de <code>$2 = .</code>
</LI>
<LI>7 = desplazamiento de comienzo de <code>$3 = 47</code>
</LI>
</UL>

<P>
Esto es lo que dice <A NAME="tex2html65"
  HREF="http://search.cpan.org/perldoc/?perlvar"><TT>perlvar</TT></A>
sobre <code>@-</code>:

<P>
<BLOCKQUOTE><I>This array holds the offsets of the beginnings of the last successful
submatches in the currently active dynamic scope. <code>$-[0]</code> is the offset
into the string of the beginning of the entire match. The nth element of
this array holds the offset of the nth submatch, so <code>$-[1]</code> is the offset
where <code>$1</code> begins, <code>$-[2]</code> the offset where <code>$2</code> begins, and so on.
</I></BLOCKQUOTE>
<P>
<BLOCKQUOTE><I>After a match against some variable <code>$var</code>:
</I></BLOCKQUOTE>
<P><PRE>
    $` is the same as substr($var, 0, $-[0])
    $&amp; is the same as substr($var, $-[0], $+[0] - $-[0])
    $' is the same as substr($var, $+[0])
    $1 is the same as substr($var, $-[1], $+[1] - $-[1])
    $2 is the same as substr($var, $-[2], $+[2] - $-[2])
    $3 is the same as substr($var, $-[3], $+[3] - $-[3])
</PRE>
<P>

<P>

<H4><A NAME="SECTION00814040000000000000">
Desplazamientos de los Finales de los Emparejamientos: <TT>@+</TT></A>
</H4>
  

<A NAME="parrafo:fincas"></A>
<P>
El array <code>@+</code> contiene los desplazamientos de 
los finales de los emparejamientos.
La entrada <code>$+[0]</code> contiene el desplazamiento del final de la cadena
del emparejamiento completo.
Siguiendo con el ejemplo anterior:
<PRE>
#            0123456789
DB&lt;17&gt; $z = "hola13.47x"
DB&lt;18&gt; if ($z =~ m{a(\d+)(\.)(\d+)?}) { print "@+\n"; }
9 6 7 9
</PRE>
El resultado se interpreta como sigue:

<UL>
<LI>9 = desplazamiento final de <code>$&amp; = a13.47x</code> 
</LI>
<LI>6 = desplazamiento final de <code>$1 = 13</code>
</LI>
<LI>7 = desplazamiento final de <code>$2 = .</code>
</LI>
<LI>9 = desplazamiento final de <code>$3 = 47</code>
</LI>
</UL>

<P>

<H4><A NAME="SECTION00814050000000000000">
Número de paréntesis en la última regexp con éxito</A>
</H4>
  

<P>
Se puede usar <code>$#+</code> para determinar cuantos parentesis
había en el último emparejamiento que tuvo éxito.
<PRE>
  DB&lt;29&gt; $z = "h"
  DB&lt;30&gt; print "$#+\n" if ($z =~ m{(a)(b)}) || ($z =~ m{(h)(.)?(.)?})
3
  DB&lt;31&gt; $z = "ab"
  DB&lt;32&gt; print "$#+\n" if ($z =~ m{(a)(b)}) || ($z =~ m{(h)(.)?(.)?})
2
</PRE>

<P>

<H4><A NAME="SECTION00814060000000000000">
Indice del Ultimo Paréntesis</A>
</H4>
  

<A NAME="parrafo:lastpar"></A>
<P>
La variable <code>$#-</code> contiene el índice del último paréntesis
que casó. Observe la siguiente ejecución con el depurador:
<PRE>
  DB&lt;1&gt; $x = '13.47'; $y = '125'
  DB&lt;2&gt; if ($y =~ m{(\d+)(\.(\d+))?}) { print "last par = $#-, content = $+\n"; }
last par = 1, content = 125
  DB&lt;3&gt; if ($x =~ m{(\d+)(\.(\d+))?}) { print "last par = $#-, content = $+\n"; }
last par = 3, content = 47
</PRE>

<P>

<H4><A NAME="SECTION00814070000000000000">
<TT>@-</TT> y <TT>@+</TT> no tienen que tener el mismo tamaño</A>
</H4>
  

<P>
En general no puede asumirse que <code>@-</code> y <code>@+</code> sean 
del mismo tamaño.
<PRE>
  DB&lt;1&gt; "a" =~ /(a)|(b)/; @a = @-; @b = @+
  DB&lt;2&gt; x @a
0  0
1  0
  DB&lt;3&gt; x @b
0  1
1  1
2  undef
</PRE>

<P>

<H4><A NAME="SECTION00814080000000000000">
Véase También</A>
</H4>
  

<P>
Para saber más sobre las variables especiales disponibles
consulte 

<P>

<UL>
<LI><code>perldoc</code> <A NAME="tex2html66"
  HREF="http://search.cpan.org/perldoc/?perlretut"><TT>perlretut</TT></A>
</LI>
<LI><code>perldoc</code> <A NAME="tex2html67"
  HREF="http://search.cpan.org/perldoc/?perlvar"><TT>perlvar</TT></A>.
</LI>
</UL>

<P>
<HR>
<A NAME="tex2html1863"
  HREF="node54.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1857"
  HREF="node49.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1851"
  HREF="node52.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1859"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1861"
  HREF="node322.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html2"
  HREF="http://nereida.deioc.ull.es/~pl/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="PL.jpg"
 ALT="PL"></A><A NAME="tex2html3"
  HREF="http://campusvirtual.ull.es/0910/course/view.php?id=1148"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="hatpl.png"
 ALT="PL moodle"></A><A NAME="tex2html4"
  HREF="pl.ps"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="ps"></A><A NAME="tex2html5"
  HREF="perl_errata_form.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="icon_errata.jpg"
 ALT="errata"></A><A NAME="tex2html6"
  HREF="http://search.cpan.org/"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="modulos"></A><A NAME="tex2html7"
  HREF="http://www.perlmonks.org/?node=Seekers of Perl Wisdom"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="monk.gif"
 ALT="perlmonks"></A><A NAME="tex2html8"
  HREF="http://perldoc.perl.org/"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html9"
  HREF="http://nereida.deioc.ull.es/~lhp/perlexamples/"><IMG
  WIDTH="22" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLHP.jpg"
 ALT="apuntes LHP"></A><A NAME="tex2html10"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html11"
  HREF="http://www.etsii.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html12"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html13"
  HREF="http://nereida.deioc.ull.es/"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="pcgull"></A>
<BR>
<B> Sig:</B> <A NAME="tex2html1864"
  HREF="node54.html">Ambito Automático</A>
<B>Sup:</B> <A NAME="tex2html1858"
  HREF="node49.html">Introducción</A>
<B> Ant:</B> <A NAME="tex2html1852"
  HREF="node52.html">Tablas de Escapes, Metacarácteres,</A>
 <B>Err:</B> <a href="perl_errata_form.html" target="_blank">Si hallas una errata ...</a>

<!--End of Navigation Panel-->
<ADDRESS>
<I>Casiano Rodríguez León <BR>
2013-03-05</I>
</ADDRESS>
</BODY>
</HTML>

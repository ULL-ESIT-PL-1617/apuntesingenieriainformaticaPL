<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Verbos que controlan el retroceso</TITLE>
<META NAME="description" CONTENT="Verbos que controlan el retroceso">
<META NAME="keywords" CONTENT="perlexamples">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="mystyle.css">

<LINK REL="previous" HREF="node66.html">
<LINK REL="up" HREF="node56.html">
<LINK REL="next" HREF="node68.html">
</HEAD>

<BODY >

<A NAME="tex2html2173"
  HREF="node68.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html2167"
  HREF="node56.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html2163"
  HREF="node66.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html2169"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html2171"
  HREF="node322.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html2"
  HREF="http://nereida.deioc.ull.es/~pl/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="PL.jpg"
 ALT="PL"></A><A NAME="tex2html3"
  HREF="http://campusvirtual.ull.es/0910/course/view.php?id=1148"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="hatpl.png"
 ALT="PL moodle"></A><A NAME="tex2html4"
  HREF="pl.ps"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="ps"></A><A NAME="tex2html5"
  HREF="perl_errata_form.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="icon_errata.jpg"
 ALT="errata"></A><A NAME="tex2html6"
  HREF="http://search.cpan.org/"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="modulos"></A><A NAME="tex2html7"
  HREF="http://www.perlmonks.org/?node=Seekers of Perl Wisdom"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="monk.gif"
 ALT="perlmonks"></A><A NAME="tex2html8"
  HREF="http://perldoc.perl.org/"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html9"
  HREF="http://nereida.deioc.ull.es/~lhp/perlexamples/"><IMG
  WIDTH="22" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLHP.jpg"
 ALT="apuntes LHP"></A><A NAME="tex2html10"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html11"
  HREF="http://www.etsii.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html12"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html13"
  HREF="http://nereida.deioc.ull.es/"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="pcgull"></A>
<BR>
<B> Sig:</B> <A NAME="tex2html2174"
  HREF="node68.html">Unicode</A>
<B>Sup:</B> <A NAME="tex2html2168"
  HREF="node56.html">Algunas Extensiones</A>
<B> Ant:</B> <A NAME="tex2html2164"
  HREF="node66.html">Expresiones Condicionales</A>
 <B>Err:</B> <a href="perl_errata_form.html" target="_blank">Si hallas una errata ...</a>
<BR> <P>

<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsecciones</STRONG></A>

<UL>
<LI><UL>
<LI><A NAME="tex2html2175"
  HREF="node67.html#SECTION008211010000000000000">El verbo de control <TT>(*FAIL)</TT></A>
<LI><A NAME="tex2html2176"
  HREF="node67.html#SECTION008211020000000000000">El verbo de control <TT>(*ACCEPT)</TT></A>
<LI><A NAME="tex2html2177"
  HREF="node67.html#SECTION008211030000000000000">El verbo <TT>SKIP</TT></A>
<LI><A NAME="tex2html2178"
  HREF="node67.html#SECTION008211040000000000000">Marcas</A>
<LI><A NAME="tex2html2179"
  HREF="node67.html#SECTION008211050000000000000">Poniendo un espacio después de cada signo de puntuación</A>
</UL></UL>
<!--End of Table of Child-Links-->
<HR>

<H2><A NAME="SECTION008211000000000000000">
Verbos que controlan el retroceso</A>
</H2>

<P>

<H4><A NAME="SECTION008211010000000000000">
El verbo de control <TT>(*FAIL)</TT></A>
</H4>
  

<P>
Tomado de la sección 'Backtracking-control-verbs' en <A NAME="tex2html114"
  HREF="http://perldoc.perl.org/perlretut.html#Backtracking-control-verbs"><TT>perlretut</TT></A>:

<P>
<BLOCKQUOTE><I>The control verb <code>(*FAIL)</code> may be abbreviated as <code>(*F)</code>. 
If this is inserted in a regexp it
will cause to fail, just like at some mismatch between the pattern and
the string. Processing of the regexp continues like after any "normal"
failure, so that the next position in the string or
another alternative will be tried. As failing to match doesn't preserve
capture buffers or produce results, it may be necessary to use this in
combination with embedded code.
</I></BLOCKQUOTE>

<P>
<PRE>
pl@nereida:~/Lperltesting$ cat -n vowelcount.pl
     1  #!/usr/local/lib/perl/5.10.1/bin//perl5.10.1  -w
     2  use strict;
     3
     4  my $input = shift() || &lt;STDIN&gt;;
     5  my %count = ();
     6  $input =~ /([aeiou])(?{ $count{$1}++; })(*FAIL)/i;
     7  printf("'%s' =&gt; %3d\n", $_, $count{$_})  for (sort keys %count);
</PRE>
Al ejecutarse con entrada <code>supercalifragilistico</code> produce la salida:
<PRE>
pl@nereida:~/Lperltesting$ ./vowelcount.pl
supercalifragilistico
'a' =&gt;   2
'e' =&gt;   1
'i' =&gt;   4
'o' =&gt;   1
'u' =&gt;   1
</PRE>

<P>
<P>
<DIV><B>Ejercicio  3.2.5</B> &nbsp; 
<I>¿Que queda en <code>$1</code> depués de ejecutado el matching 
<code>$input =~ /([aeiou])(?{ $count{$1}++; })(*FAIL)/i;</code>?</I></DIV><P></P>

<P>
Véase  también:

<UL>
<LI>El nodo en <A NAME="tex2html115"
  HREF="http://www.perlmonks.org/?node_id=796576">PerlMonks</A>
<B>The Oldest Plays the Piano</B>
</LI>
<LI>Véase el ejercicio <I>Las tres hijas</I> en la sección
<A HREF="node74.html#parrfo:lastreshijas">3.4.4</A>
</LI>
</UL>

<P>

<H4><A NAME="SECTION008211020000000000000">
El verbo de control <TT>(*ACCEPT)</TT></A>
</H4>
  

<P>
Tomado de <A NAME="tex2html116"
  HREF="http://search.cpan.org/perldoc/?perlretut"><TT>perlretut</TT></A>:

<P>
<BLOCKQUOTE><I>This pattern matches nothing and causes the end of successful matching
at the point at which the <code>(*ACCEPT)</code> pattern was encountered, regardless
of whether there is actually more to match in the string. When inside
of a nested pattern, such as recursion, or in a subpattern dynamically
generated via <code>(??{})</code>, only the innermost pattern is ended immediately.
</I></BLOCKQUOTE>
<P>
<BLOCKQUOTE><I>If the <code>(*ACCEPT)</code> is inside of capturing buffers then the buffers are
marked as ended at the point at which the <code>(*ACCEPT)</code> was encountered. For
instance:
</I></BLOCKQUOTE>
<P><PRE>
  DB&lt;1&gt; x 'AB' =~ /(A (A|B(*ACCEPT)|C) D)(E)/x
0  'AB'
1  'B'
2  undef
  DB&lt;2&gt; x 'ACDE'  =~ /(A (A|B(*ACCEPT)|C) D)(E)/x
0  'ACD'
1  'C'
2  'E'
</PRE>
<P>

<P>

<H4><A NAME="SECTION008211030000000000000">
El verbo <TT>SKIP</TT></A>
</H4>
  

<P>
<BLOCKQUOTE><I>This zero-width pattern 
prunes the backtracking tree at the current point
when backtracked into on failure. Consider the pattern <code>A (*SKIP) B</code>,
where <code>A</code> and <code>B</code> are complex patterns. Until the <code>(*SKIP)</code> verb is reached,
<code>A</code> may backtrack as necessary to match. Once it is reached, matching
continues in <code>B</code>, which may also backtrack as necessary; however, should <code>B</code>
not match, then no further backtracking will take place, and the pattern
will fail outright at the current starting position.
</I></BLOCKQUOTE>
<P>
<BLOCKQUOTE><I>It also signifies that whatever text that was matched leading up to the
<code>(*SKIP)</code>  pattern being executed cannot be part of any match of this
pattern. This effectively means that the regex engine <code>skips</code> forward
to this position on failure and tries to match again, (assuming that
there is sufficient room to match).
</I></BLOCKQUOTE>
<P>
<BLOCKQUOTE><I>The name of the <code>(*SKIP:NAME)</code> pattern has special significance. If a
<code>(*MARK:NAME)</code> was encountered while matching, then it is that position
which is used as the "skip point". If no <code>(*MARK)</code> of that name was
encountered, then the <code>(*SKIP)</code> operator has no effect. When used without
a name the "skip point" is where the match point was when executing the
<code>(*SKIP)</code> pattern.
</I></BLOCKQUOTE>

<P>
Ejemplo:

<P>
<PRE>
pl@nereida:~/Lperltesting$ cat -n SKIP.pl
     1  #!/soft/perl5lib/bin/perl5.10.1 -w
     2  use strict;
     3  use v5.10;
     4
     5  say "NO SKIP: /a+b?(*FAIL)/";
     6  our $count = 0;
     7  'aaab' =~ /a+b?(?{print "$&amp;\n"; $count++})(*FAIL)/;
     8  say "Count=$count\n";
     9
    10  say "WITH SKIP: a+b?(*SKIP)(*FAIL)/";
    11  $count = 0;
    12  'aaab' =~ /a+b?(*SKIP)(?{print "$&amp;\n"; $count++})(*FAIL)/;
    13  say "WITH SKIP: Count=$count\n";
    14
    15  say "WITH SKIP /a+(*SKIP)b?(*FAIL)/:";
    16  $count = 0;
    17  'aaab' =~ /a+(*SKIP)b?(?{print "$&amp;\n"; $count++})(*FAIL)/;
    18  say "Count=$count\n";
    19
    20  say "WITH SKIP /(*SKIP)a+b?(*FAIL): ";
    21  $count = 0;
    22  'aaab' =~ /(*SKIP)a+b?(?{print "$&amp;\n"; $count++})(*FAIL)/;
    23  say "Count=$count\n";
</PRE>

<P>
Ejecución:

<P>
<PRE>
pl@nereida:~/Lperltesting$ perl5.10.1 SKIP.pl
NO SKIP: /a+b?(*FAIL)/
aaab
aaa
aa
a
aab
aa
a
ab
a
Count=9

WITH SKIP: a+b?(*SKIP)(*FAIL)/
aaab
WITH SKIP: Count=1

WITH SKIP /a+(*SKIP)b?(*FAIL)/:
aaab
aaa
Count=2

WITH SKIP /(*SKIP)a+b?(*FAIL):
aaab
aaa
aa
a
aab
aa
a
ab
a
Count=9
</PRE>

<P>

<H4><A NAME="SECTION008211040000000000000">
Marcas</A>
</H4>
  

<P>
Tomado de la sección 'Backtracking-control-verbs' en <A NAME="tex2html117"
  HREF="http://perldoc.perl.org/perlretut.html#Backtracking-control-verbs"><TT>perlretut</TT></A>:

<P>
<BLOCKQUOTE><I><code>(*MARK:NAME) (*:NAME)</code>
</I></BLOCKQUOTE>
<P>
<BLOCKQUOTE><I>This zero-width pattern can be used to mark the point reached in a string
when a certain part of the pattern has been successfully matched. This
mark may be given a name. A later <code>(*SKIP)</code> pattern will then skip
forward to that point if backtracked into on failure. Any number of
<code>(*MARK)</code> patterns are allowed, and the <code>NAME</code> portion is optional and may
be duplicated.
</I></BLOCKQUOTE>
<P>
<BLOCKQUOTE><I>In addition to interacting with the <code>(*SKIP)</code> pattern, <code>(*MARK:NAME)</code> can
be used to <code>label</code> a pattern branch, so that after matching, the program
can determine which branches of the pattern were involved in the match.
</I></BLOCKQUOTE>
<P>
<BLOCKQUOTE><I>When a match is successful, the <code>$REGMARK</code> variable will be set to the name
of the most recently executed <code>(*MARK:NAME)</code> that was involved in the match.
</I></BLOCKQUOTE>
<P>
<BLOCKQUOTE><I>This can be used to determine which branch of a pattern was
matched without using a separate capture buffer for each branch,
which in turn can result in a performance improvement.
</I></BLOCKQUOTE>
<P>
<BLOCKQUOTE><I>When a match has failed, and unless another verb has been involved in
failing the match and has provided its own name to use, the <code>$REGERROR</code>
variable will be set to the name of the most recently executed
<code>(*MARK:NAME)</code>.
</I></BLOCKQUOTE>

<P>
<PRE>
pl@nereida:~/Lperltesting$ cat -n mark.pl
 1  use v5.10;
 2  use strict;
 3
 4  our $REGMARK;
 5
 6  $_ = shift;
 7  say $REGMARK if /(?:x(*MARK:mx)|y(*MARK:my)|z(*MARK:mz))/;
 8  say $REGMARK if /(?:x(*:xx)|y(*:yy)|z(*:zz))/;
</PRE>
Cuando se ejecuta produce:
<PRE>
pl@nereida:~/Lperltesting$ perl5.10.1 mark.pl y
my
yy
pl@nereida:~/Lperltesting$ perl5.10.1 mark.pl z
mz
zz
</PRE>

<P>

<H4><A NAME="SECTION008211050000000000000">
Poniendo un espacio después de cada signo de puntuación</A>
</H4>
  

<P>
Se quiere poner un espacio en blanco después de la aparición de cada coma:

<P>
<PRE>
s/,/, /g;
</PRE>

<P>
pero se quiere que la sustitución no tenga lugar si la coma esta
incrustada entre dos dígitos. Además se pide que si hay ya un espacio
después de la coma, no se duplique. Sigue una solución que
usa marcas:

<P>
<PRE>
pl@nereida:~/Lperltesting$ perl5.10.1 -wdE 0
main::(-e:1):   0
  DB&lt;1&gt; $a = 'ab,cd, ef,12,34,efg,56,78,df, ef,'
  DB&lt;2&gt; x ($b = $a) =~ s/\d,\d(*:d)|,(?!\s)/($REGMARK eq 'd')? $&amp; : ', '/ge
0  8
  DB&lt;3&gt; p "&lt;$b&gt;"
&lt;ab, cd, ef, 12,34, efg, 56,78, df, ef, &gt;
</PRE>

<P>
<HR>
<A NAME="tex2html2173"
  HREF="node68.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html2167"
  HREF="node56.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html2163"
  HREF="node66.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html2169"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html2171"
  HREF="node322.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html2"
  HREF="http://nereida.deioc.ull.es/~pl/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="PL.jpg"
 ALT="PL"></A><A NAME="tex2html3"
  HREF="http://campusvirtual.ull.es/0910/course/view.php?id=1148"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="hatpl.png"
 ALT="PL moodle"></A><A NAME="tex2html4"
  HREF="pl.ps"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="ps"></A><A NAME="tex2html5"
  HREF="perl_errata_form.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="icon_errata.jpg"
 ALT="errata"></A><A NAME="tex2html6"
  HREF="http://search.cpan.org/"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="modulos"></A><A NAME="tex2html7"
  HREF="http://www.perlmonks.org/?node=Seekers of Perl Wisdom"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="monk.gif"
 ALT="perlmonks"></A><A NAME="tex2html8"
  HREF="http://perldoc.perl.org/"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html9"
  HREF="http://nereida.deioc.ull.es/~lhp/perlexamples/"><IMG
  WIDTH="22" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLHP.jpg"
 ALT="apuntes LHP"></A><A NAME="tex2html10"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html11"
  HREF="http://www.etsii.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html12"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html13"
  HREF="http://nereida.deioc.ull.es/"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="pcgull"></A>
<BR>
<B> Sig:</B> <A NAME="tex2html2174"
  HREF="node68.html">Unicode</A>
<B>Sup:</B> <A NAME="tex2html2168"
  HREF="node56.html">Algunas Extensiones</A>
<B> Ant:</B> <A NAME="tex2html2164"
  HREF="node66.html">Expresiones Condicionales</A>
 <B>Err:</B> <a href="perl_errata_form.html" target="_blank">Si hallas una errata ...</a>

<!--End of Navigation Panel-->
<ADDRESS>
<I>Casiano Rodríguez León <BR>
2013-03-05</I>
</ADDRESS>
</BODY>
</HTML>
